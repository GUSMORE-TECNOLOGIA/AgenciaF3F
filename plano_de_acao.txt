================================================================================
PLANO DE A√á√ÉO - AG√äNCIA F3F
================================================================================

√öltima Atualiza√ß√£o: 20/01/2026 11:48:55
Status: Banco e deploy ok; valida√ß√µes pendentes; Equipe/Perfis em implementa√ß√£o; Atendimento em desenvolvimento

================================================================================
INFORMA√á√ïES DO PROJETO
================================================================================

Projeto Supabase: F3F
Project ID: rhnkffeyspymjpellmnd
URL: https://rhnkffeyspymjpellmnd.supabase.co
Dashboard: https://app.supabase.com/project/rhnkffeyspymjpellmnd

IMPORTANTE: Documenta√ß√£o completa de integra√ß√µes em:
.context/docs/PROJECT_INTEGRATIONS.md

================================================================================
OBJETIVO
================================================================================

Desenvolver um sistema web completo para gest√£o de clientes e servi√ßos da
Ag√™ncia F3F, permitindo que cada usu√°rio gerencie seus clientes atribu√≠dos,
com foco em:
- Gest√£o completa de clientes com links √∫teis espec√≠ficos
- Gest√£o de planos e servi√ßos prestados
- Controle financeiro (transa√ß√µes)
- Sistema de ocorr√™ncias e atendimento
- Gest√£o de equipe e respons√°veis

================================================================================
ESTRUTURA DE DADOS
================================================================================

ENTIDADES PRINCIPAIS:

1. Usu√°rios (usuarios)
   - id (UUID, PK, FK auth.users)
   - email (TEXT, UNIQUE)
   - name (TEXT)
   - role (admin | user)
   - timestamps

2. Clientes (clientes)
   - id (UUID, PK)
   - nome (TEXT)
   - email (TEXT, opcional)
   - telefone (TEXT, opcional)
   - responsavel_id (UUID, FK usuarios)
   - status (ativo | inativo | pausado)
   - links_uteis (JSONB) - 11 campos espec√≠ficos
   - drive_url (TEXT, opcional)
   - logo_url (TEXT, opcional)
   - timestamps + soft delete

3. Servi√ßos (servicos) - Cadastro Mestre
   - id (UUID, PK)
   - nome (TEXT)
   - descricao (TEXT, opcional)
   - valor (DECIMAL, opcional)
   - ativo (BOOLEAN)
   - timestamps + soft delete

4. Servi√ßos Prestados (servicos_prestados) - Legado
   - id (UUID, PK)
   - cliente_id (UUID, FK clientes)
   - nome (TEXT)
   - descricao (TEXT, opcional)
   - tipo (TEXT)
   - status (ativo | pausado | finalizado)
   - valor (DECIMAL)
   - data_inicio (DATE)
   - data_fim (DATE, opcional)
   - timestamps + soft delete

5. Planos (planos)
   - id (UUID, PK)
   - nome (TEXT)
   - descricao (TEXT, opcional)
   - valor (DECIMAL)
   - moeda (TEXT, default 'BRL')
   - ativo (BOOLEAN)
   - timestamps + soft delete

6. Plano-Servi√ßos (plano_servicos) - Rela√ß√£o N:N
   - id (UUID, PK)
   - plano_id (UUID, FK planos)
   - servico_id (UUID, FK servicos)
   - ordem (INTEGER)
   - timestamps

7. Cliente-Planos (cliente_planos) - Contratos
   - id (UUID, PK)
   - cliente_id (UUID, FK clientes)
   - plano_id (UUID, FK planos)
   - valor (DECIMAL)
   - moeda (TEXT)
   - status (ativo | pausado | cancelado | finalizado)
   - data_inicio (DATE)
   - data_fim (DATE, opcional)
   - observacoes (TEXT)
   - timestamps + soft delete

8. Cliente-Servi√ßos (cliente_servicos) - Contratos Avulsos
   - id (UUID, PK)
   - cliente_id (UUID, FK clientes)
   - servico_id (UUID, FK servicos)
   - valor (DECIMAL)
   - moeda (TEXT)
   - status (ativo | pausado | cancelado | finalizado)
   - data_inicio (DATE)
   - data_fim (DATE, opcional)
   - observacoes (TEXT)
   - timestamps + soft delete

9. Transa√ß√µes (transacoes)
   - id (UUID, PK)
   - cliente_id (UUID, FK clientes)
   - servico_id (UUID, FK, opcional)
   - tipo (receita | despesa)
   - categoria (TEXT)
   - valor (DECIMAL)
   - moeda (TEXT)
   - descricao (TEXT)
   - metodo_pagamento (TEXT)
   - status (pendente | pago | vencido | cancelado | reembolsado)
   - data_vencimento (DATE)
   - data_pagamento (TIMESTAMPTZ, opcional)
   - external_transaction_id (TEXT, opcional)
   - external_source (TEXT, opcional)
   - metadata (JSONB)
   - timestamps + soft delete

10. Ocorr√™ncia Grupos (ocorrencia_grupos)
    - id (UUID, PK)
    - nome (TEXT)
    - descricao (TEXT)
    - is_active (BOOLEAN)
    - responsavel_id (UUID, FK usuarios)
    - timestamps

11. Ocorr√™ncia Tipos (ocorrencia_tipos)
    - id (UUID, PK)
    - grupo_id (UUID, FK ocorrencia_grupos)
    - nome (TEXT)
    - descricao (TEXT)
    - is_active (BOOLEAN)
    - responsavel_id (UUID, FK usuarios)
    - timestamps

12. Ocorr√™ncias (ocorrencias)
    - id (UUID, PK)
    - cliente_id (UUID, FK clientes)
    - grupo_id (UUID, FK ocorrencia_grupos)
    - tipo_id (UUID, FK ocorrencia_tipos)
    - ocorreu_em (DATE)
    - notas (TEXT)
    - responsavel_id (UUID, FK usuarios)
    - prioridade (baixa | media | alta | urgente)
    - is_sensitive (BOOLEAN)
    - status (aberta | em_andamento | resolvida | cancelada)
    - timestamps + soft delete

13. Atendimentos (atendimentos)
    - id (UUID, PK)
    - cliente_id (UUID, FK clientes)
    - usuario_id (UUID, FK usuarios)
    - tipo (email | whatsapp | telefone | presencial)
    - assunto (TEXT)
    - descricao (TEXT)
    - data_atendimento (TIMESTAMPTZ)
    - duracao_minutos (INTEGER, opcional)
    - timestamps + soft delete

14. Equipe Membros (equipe_membros)
    - id (UUID, PK)
    - nome_completo (TEXT)
    - email (TEXT, opcional)
    - telefone (TEXT, opcional)
    - cargo (admin | gerente | agente | suporte)
    - status (ativo | inativo)
    - user_id (UUID, FK auth.users, opcional)
    - responsavel_id (UUID, FK usuarios)
    - timestamps + soft delete

15. Cliente Respons√°veis (cliente_responsaveis)
    - id (UUID, PK)
    - cliente_id (UUID, FK clientes)
    - responsavel_id (UUID, FK usuarios)
    - roles (TEXT[]) - principal, comercial, suporte, backup
    - observacao (TEXT)
    - timestamps + soft delete

16. Contrato Status Hist√≥rico (contrato_status_historico)
    - id (UUID, PK)
    - tipo_contrato (plano | servico)
    - contrato_id (UUID)
    - status_anterior (TEXT)
    - status_novo (TEXT)
    - usuario_id (UUID, FK usuarios)
    - observacoes (TEXT)
    - metadata (JSONB)
    - created_at (TIMESTAMPTZ)

LINKS √öTEIS (JSONB em clientes.links_uteis):
- conta_anuncio_f3f
- conta_anuncio_lt
- instagram
- business_suite
- dashboard
- planilha_dados
- pasta_drive
- utmify
- wordpress
- pagina_vendas_lt
- checkout

================================================================================
COMPONENTES IMPLEMENTADOS
================================================================================

FRONTEND:

1. Autentica√ß√£o ‚úÖ
   - Login.tsx
   - ProtectedRoute.tsx
   - AuthContext.tsx

2. Layout ‚úÖ
   - Layout.tsx (container principal)
   - Sidebar.tsx (navega√ß√£o)
   - Header.tsx (barra superior)

3. P√°ginas Principais ‚úÖ
   - Dashboard.tsx
   - Clientes/
     - Clientes.tsx (lista com filtros)
     - ClienteNovo.tsx (formul√°rio de cria√ß√£o)
     - ClienteEdit.tsx (formul√°rio de edi√ß√£o com abas)
     - components/tabs/ (IdentificacaoTab, LinksUteisTab, ResponsaveisTab)
   - Servicos/
     - Servicos.tsx (lista com filtros)
     - ServicoNovo.tsx (formul√°rio de cria√ß√£o)
     - ServicoEdit.tsx (formul√°rio de edi√ß√£o)
   - Planos/
     - Planos.tsx (lista com filtros)
     - PlanoNovo.tsx (formul√°rio de cria√ß√£o)
     - PlanoEdit.tsx (formul√°rio de edi√ß√£o)
     - PlanoDetail.tsx (detalhes + rela√ß√£o N:N com servi√ßos)
   - Financeiro/
     - Financeiro.tsx (lista com filtros e cards de resumo)
     - TransacaoNovo.tsx (formul√°rio de cria√ß√£o)
     - TransacaoEdit.tsx (formul√°rio de edi√ß√£o)
   - Ocorrencias/
     - Ocorrencias.tsx (lista com filtros)
     - OcorrenciaNovo.tsx (formul√°rio de cria√ß√£o)
     - OcorrenciaEdit.tsx (formul√°rio de edi√ß√£o)
   - Atendimento/
     - Atendimento.tsx (lista com filtros)
     - AtendimentoNovo.tsx (formul√°rio de cria√ß√£o)
     - AtendimentoEdit.tsx (formul√°rio de edi√ß√£o)

4. Services ‚úÖ
   - supabase.ts (cliente Supabase)
   - clientes.ts (CRUD de clientes)
   - planos.ts (CRUD de planos, servi√ßos, rela√ß√µes)
   - financeiro.ts (CRUD de transa√ß√µes)
   - ocorrencias.ts (CRUD de ocorr√™ncias)
   - atendimentos.ts (CRUD de atendimentos)
   - usuarios.ts (consulta de usu√°rios)

5. Hooks ‚úÖ
   - useClientes.ts, useCliente.ts
   - usePlanos.ts (servi√ßos, planos, rela√ß√µes, contratos)
   - useFinanceiro.ts
   - useOcorrencias.ts
   - useAtendimentos.ts
   - useUsuarios.ts

6. Validators (Zod) ‚úÖ
   - cliente-schema.ts
   - plano-schema.ts
   - servico-schema.ts
   - financeiro-schema.ts
   - ocorrencia-schema.ts
   - atendimento-schema.ts

7. Types ‚úÖ
   - types/index.ts (defini√ß√µes TypeScript completas)

BACKEND (Supabase):

1. Script Consolidado ‚úÖ
   - .context/cleanup/f3f_apply_all.sql (706 linhas)
   - Inclui: tabelas, √≠ndices, fun√ß√µes, triggers, pol√≠ticas RLS
   - Idempotente (pode ser executado m√∫ltiplas vezes)

2. Pol√≠ticas RLS ‚úÖ
   - Implementadas no script consolidado
   - Baseadas em responsavel_id para clientes
   - Diferencia√ß√£o admin/user

================================================================================
FASES DE DESENVOLVIMENTO
================================================================================

FASE 1: Estrutura Base ‚úÖ CONCLU√çDA
- [x] Configura√ß√£o do projeto React + TypeScript
- [x] Estrutura de pastas
- [x] Configura√ß√£o Tailwind CSS
- [x] Sistema de rotas
- [x] Autentica√ß√£o b√°sica
- [x] Layout principal
- [x] Estrutura de tipos

FASE 2: Banco de Dados ‚úÖ CONCLU√çDA
- [x] Script SQL consolidado criado
- [x] Executar script no Supabase F3F (‚úÖ conclu√≠do - 20/01/2026)
- [x] Testar conex√£o (‚úÖ 16 tabelas criadas, RLS habilitado, dados existentes)

FASE 3: M√≥dulo de Clientes ‚úÖ CONCLU√çDA
- [x] Estrutura b√°sica
- [x] P√°gina de listagem com filtros
- [x] Formul√°rio de cria√ß√£o
- [x] Formul√°rio de edi√ß√£o com abas
- [x] Interface de edi√ß√£o de Links √öteis
- [x] Integra√ß√£o com Supabase

FASE 4: M√≥dulos Restantes üîÑ EM ANDAMENTO
- [x] M√≥dulo de Servi√ßos (CRUD completo)
- [x] M√≥dulo de Planos (CRUD completo + rela√ß√£o N:N)
- [x] M√≥dulo Financeiro (CRUD completo + resumos)
- [x] M√≥dulo de Ocorr√™ncias (CRUD completo + badges)
- [ ] M√≥dulo de Atendimento (em desenvolvimento, adiado)

FASE 5: Melhorias e Polimento üîÑ EM ANDAMENTO
- [ ] Dashboard com m√©tricas reais
- [ ] Filtros e buscas avan√ßadas
- [ ] Relat√≥rios
- [ ] Exporta√ß√£o de dados
- [ ] Notifica√ß√µes
- [ ] CRUD de Equipe (membros)
- [ ] Perfil de usu√°rio + reset de senha no primeiro login
- [x] Deploy no Vercel (‚úÖ conclu√≠do - 20/01/2026)

================================================================================
VALIDA√á√ïES
================================================================================

1. Autentica√ß√£o
   - [x] Login funcional
   - [ ] Reset de senha no primeiro login
   - [ ] Prote√ß√£o de rotas
   - [ ] Sess√£o persistente

2. Clientes
   - [x] Listagem de clientes
   - [x] Cria√ß√£o de cliente
   - [x] Edi√ß√£o de cliente
   - [x] Exclus√£o (soft delete)
   - [x] Links √∫teis funcionais
   - [x] Acesso ao Drive

3. Seguran√ßa
   - [x] RLS no script consolidado
   - [ ] Testar RLS ap√≥s aplicar migrations
   - [ ] Valida√ß√£o de permiss√µes

4. Performance
   - [x] √çndices no script consolidado
   - [ ] Testar queries ap√≥s aplicar migrations
   - [ ] Pagina√ß√£o implementada

================================================================================
CHECKLIST T√âCNICO
================================================================================

Configura√ß√£o:
- [x] package.json com depend√™ncias
- [x] tsconfig.json configurado
- [x] vite.config.ts configurado
- [x] tailwind.config.js configurado
- [x] .eslintrc.cjs configurado
- [x] .gitignore configurado
- [x] .env configurado (F3F)

Estrutura:
- [x] Pastas organizadas
- [x] Componentes criados
- [x] P√°ginas criadas
- [x] Tipos definidos
- [x] Servi√ßos criados
- [x] Hooks criados
- [x] Validators criados

Funcionalidades:
- [x] Rotas configuradas
- [x] Autentica√ß√£o estruturada
- [x] Layout responsivo
- [x] CRUD de clientes (completo)
- [x] CRUD de servi√ßos (completo)
- [x] CRUD de planos (completo)
- [x] CRUD de financeiro (completo)
- [x] CRUD de ocorr√™ncias (completo)
- [x] CRUD de atendimento (completo)

Documenta√ß√£o:
- [x] README.md
- [x] Atividades.txt
- [x] Pendencias.txt
- [x] plano_de_acao.txt
- [x] PROJECT_INTEGRATIONS.md
- [x] Script SQL consolidado

================================================================================
PR√ìXIMOS PASSOS IMEDIATOS
================================================================================

1. EXECUTAR SCRIPT NO SUPABASE F3F
   - Acessar: https://app.supabase.com/project/rhnkffeyspymjpellmnd
   - SQL Editor > Colar conte√∫do de .context/cleanup/f3f_apply_all.sql
   - Executar

2. LIMPAR SUPABASE UPLOADERS (se necess√°rio)
   - Acessar: https://app.supabase.com/project/thckhkrbqtecouqlnaeq
   - SQL Editor > Colar conte√∫do de .context/cleanup/uploaders_cleanup.sql
   - Executar

3. TESTAR AUTENTICA√á√ÉO
   - Login com: adm@agenciaf3f.com.br / adm@123
   - Verificar se sess√£o persiste
   - Testar logout

4. TESTAR M√ìDULOS
   - Criar um cliente de teste
   - Criar transa√ß√µes, ocorr√™ncias, atendimentos
   - Verificar integra√ß√£o com banco

5. DEPLOY
   - Configurar projeto no Vercel
   - Configurar vari√°veis de ambiente
   - Deploy de produ√ß√£o

================================================================================
